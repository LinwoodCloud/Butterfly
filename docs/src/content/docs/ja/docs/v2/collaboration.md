---
title: コラボレーション
---

:::caution[🧪 実験]

この機能は実験フラグの背後にあります。 Read more [here](/nightly#experiments).
このセクションのすべてが変更されることがあります。

:::

## はじめに

2.0ベータ版以来、Butterflyはコラボレーションをサポートしています。 つまり、複数の人と同時に同じファイルを編集することができます。 これはドキュメントで一緒に作業する場合に便利です。

## 仕組み

Butterflyは、お使いのコンピュータでホストされるWebSocketサーバーを使用します。 このサーバーは、インターネットまたはローカルネットワークからアクセスできる必要があります。 クライアントはこのサーバーに接続します。 サーバーはすべてのクライアントとすべての変更とイベントを同期します。

## サーバーのセットアップ

:::note

このサーバー機能はウェブ上では利用できません。

:::

まず、設定でコラボレーション実験を有効にします。 その後、ドキュメントを開き、共有します。 次に、タイトルの左上隅にある共有ボタンをクリックします。 これでダイアログが開きます。 `Start server` をクリックします。

デフォルトでは、サーバーはポート `28005` のすべてのインターフェイスでホストされます。 ダイアログでこれを変更できます。 このサーバーがクライアントからアクセス可能であることを確認する必要があります。
ローカルネットワークでは、これはボックスから動作するはずです。 インターネットからサーバーにアクセスしたい場合は、ルーターにポートを転送する必要があります。 You can find more information about this [here](https://en.wikipedia.org/wiki/Port_forwarding/).

ポートを転送できない場合は、 [ngrok](https://ngrok.com/) のようなサービスを使用できます。 これにより、ローカルサーバーへのトンネルが作成されます。 これは、ドキュメントを他の人と共有したい場合に便利です。

ngrok の場合、コマンドは次のようになります:

```bash
ngrok http 28005
```

## サーバーに接続

次に、サーバーに接続する必要があります。 これを行うには、ホームページに移動し、新しいドキュメントを作成するようにプラスボタンをクリックします。 そこには`Connect`という新しいメニューアイテムがあります。

これをクリックするとダイアログが表示されます。 ここに接続URLを入力します。
同じネットワークにいる場合は、サーバーが稼働しているコンピュータのローカルIPアドレスを使用できます。
url は `ws://{ip}:28005` のようになります。 コンピュータのIPアドレスに「{ip}」を置き換えます。 windows で `ipconfig` を、linux で `ifconfig` を使ってIPアドレスを見つけることができます。 Androidでは、Wi-Fi設定でIPアドレスを見つけることができます。

同じネットワークにいない場合は、コンピュータのパブリック IP アドレスを使用する必要があります。 お気に入りの検索ブラウザで、`What is my ip`を探してみましょう。 url は上記のもののように見えるべきですが、パブリック IP アドレスとします。

ngrok を使用している場合、セットアップは少し異なります。 `https`を`wss`に置き換え、最後に`:28005`を追加します。 url は `wss://{random}:28005` のようになります。 ランダムなパーツをngrokがあなたに与えるパーツと交換します。
